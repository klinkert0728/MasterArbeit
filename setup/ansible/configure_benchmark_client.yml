---
    - name: Initial config
      hosts: micro_benchmark, application_benchmark
      remote_user: benchUser
      become: yes
      tasks:
        - name: update
          command: sudo apt -y update

        - name: install git
          command: sudo apt install git -y
        
        - name: install curl
          command: sudo apt install curl -y

        - name: clone repo
          shell: git clone https://github.com/klinkert0728/MasterArbeit.git
    
    - name: Install dependencies
      hosts: micro_benchmark, application_benchmark
      remote_user: benchUser
      become: yes
      tasks:
        - name: Install depenencies for docker
          apt:
            name: ["ca-certificates", "curl", "gnupg", "software-properties-common", "apt-transport-https"]
            state: present

        - name: install pip
          command: sudo apt install python3-pip -y

    - name: Install docker
      hosts: micro_benchmark, application_benchmark
      remote_user: benchUser
      become: yes
      tasks:
        - name: Download docker key
          shell: curl -fsSL  https://download.docker.com/linux/debian/gpg | apt-key add -
        
        - name: Docker repo
          apt_repository:
            repo: "deb [arch=amd64] https://download.docker.com/linux/debian buster stable"
        
        - name: Install docker
          apt:
            name: ["docker-ce", "docker-ce-cli", "containerd.io", "docker-compose-plugin"]
            state: present

        - name: install requests requests
          command: python3 -m pip install requests

        - name: pip install Docker
          command: pip install docker

        - name: Start docker
          service:
            name: docker
            state: started
            enabled: yes

    - name: install go
      import_playbook: configure_go.yml

    - name: configure nginx
      import_playbook: configure_nginx.yml

    # - name: install tsbs
    #   hosts: application_benchmark
    #   remote_user: benchUser
    #   become: yes
    #   tasks:
    #     - name: install tsbs
    #       shell: git clone
        
    # - name: Start VM metrics docker
    #   hosts: micro_benchmark
    #   remote_user: benchUser
    #   become: yes
    #   tasks:
    #     - name: Get EU reading client target
    #       shell: #cd CSBench/readingClient && docker build -t reading-client-eu .